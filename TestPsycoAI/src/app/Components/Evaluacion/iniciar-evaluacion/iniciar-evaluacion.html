@if(accesoDenegado) {
  <app-acceso-denegado></app-acceso-denegado>
} @else {
<div class="container mt-5" style="min-height: 70vh;">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-lg">
        <div class="card-header bg-success text-white text-center d-flex justify-content-between align-items-center">
            @if (NumPregunta===-1) {
              <a class="text-white"
               [routerLink]="['/test/tomar-evaluacion']"
               >
              <h3><i class="fa fa-arrow-left"></i></h3> 
            </a>
            } @else {
              <a class="text-white"
                [routerLink]="['/test/iniciar-evaluacion', evaluacion?.id ?? 0, 'pregunta', -1]"
                >
              <h3><i class="fa fa-arrow-left"></i></h3> 
              </a>
            }
          <h3 class="mb-0 flex-grow-1 text-center"><i class="fa-solid fa-file-signature"></i> {{evaluacion?.configuracionTest?.tipoTest?.nombre}}</h3>
        </div>
        <div class="card-body">
            
            <div class="p-3">
                @if(NumPregunta==-1)
                {
                    <div innerHTML="{{evaluacion?.configuracionTest?.tipoTest?.instrucciones}}"></div>
                    <div class="d-flex justify-content-end mt-3">
                        @if(evaluacion?.iniciado && !evaluacion?.completado) {
                            <button class="btn btn-secondary me-2" 
                                [routerLink]="['/test/iniciar-evaluacion', evaluacion?.id ?? 0, 'pregunta', (evaluacion?.contestadas ?? 0)+1]" 
                                (click)="NumPregunta = evaluacion?.contestadas! + 1"
                            ><i class="fa-solid fa-arrow-rotate-right"></i> Reanudar</button>
                        } @else if(!evaluacion?.iniciado && !evaluacion?.completado) {
                            <button class="btn btn-primary me-2" 
                            [routerLink]="['/test/iniciar-evaluacion', evaluacion?.id ?? 0, 'pregunta', (evaluacion?.contestadas ?? 0)+1]"
                            (click)="NumPregunta = 1"><i class="fa-solid fa-play"></i> Iniciar</button>
                        }
                        
                    </div>
                } @else if(NumPregunta >= 0 && NumPregunta < evaluacion?.cantidadPreguntas!+1) {
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-3">Pregunta {{ NumPregunta }} de {{ evaluacion?.cantidadPreguntas }}</h5>
                        <span class="badge bg-warning text-dark" style="font-size:1rem;">
                            {{ (evaluacion?.tiempoTranscurrido! / 60) | number:'1.0-0' }}:{{ (evaluacion?.tiempoTranscurrido! % 60) | number:'1.0-0' }} min
                        </span>
                    </div>
                    <div class="mb-3" innerHTML="{{ preguntaActual.pregunta ===undefined ? '' : preguntaActual.pregunta }}"></div>
                    <div id="opciones" class="mb-3">
                        <div *ngFor="let opcion of preguntaActual.opciones; let i = index" class="form-check">
                            <input class="form-check-input" type="radio" name="inlineRadioOptions" id="op-{{opcion.id}}" [checked]="opcion.seleccionado!" (change)="siguiente=true">
                            <label class="form-check-label" for="op-{{opcion.id}}">{{ opcion.opcion }}</label>
                        </div>
                    </div>
                
                    <div class="d-flex justify-content-center mt-3">
                        @if(NumPregunta < evaluacion?.cantidadPreguntas!) {
                            <button 
                                class="btn btn-primary" [disabled]="!siguiente" 
                                (click)="siguientePregunta()"
                            >
                                <i class="fa-solid fa-arrow-right"></i> Siguiente
                            </button>
                        } @else if(NumPregunta === evaluacion?.cantidadPreguntas!) {
                            <button class="btn btn-success" [disabled]="!siguiente" (click)="finalizarEvaluacion()"><i class="fa-solid fa-check"></i> Finalizar</button>
                        }
                    </div>
                }

            </div>
            
        </div>
      </div>
    </div>
  </div>
</div>
}